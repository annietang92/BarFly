<% provide(:title, 'BarFly | Search Venues') %>
<section id="content">
  <section class="vbox">
    <section class="scrollable wrapper">
      <div class="row">
        <div class="col-lg-5">
          <section class="panel ">
            <%= render 'venues/form'%>
          </section>
        </div>
        <div class="col-lg-7">
          <% if @venues.nil?%>
            <div class="col-lg-12">
              <section class="padding_med panel bg-primary lt no-borders">
                <span class="font_white">Select from Top Bars in Your Area</span>
              </section>
            </div>
            <% @top_venues.each do |venue| %>
              <div class="col-lg-6">
                <section class="panel bg-semi-transparent ">
                    <label class="btn btn-danger lt btn-sm"><small><%=venue.name%></small></label><div class="small_space"></div>
                    <%= image_tag venue.categories[0].icon, class: "pull-right" %>
                    <%=venue.location.address%><br>
                    <%=venue.location.city%>, <%=venue.location.state%> <%venue.postalCode%><div class="small_space"></div>
                    Check-Ins: <%=venue.stats.checkinsCount%><br>
                    Likes: <%=venue.stats.tipCount%>
                </section>
              </div>
            <% end %>
          <%else%>
            <div class="col-lg-12">
              <section class="padding_med panel bg-success lt no-borders">
                <span class="font_white">Your Search Results</span>
              </section>
            </div>
            <% @venues.each do |venue| %>
              <div class="col-lg-6">
                <section class="panel bg-semi-transparent ">
                    <label class="btn btn-danger lt btn-sm"><small><%=venue.name%></small></label><div class="small_space"></div>
                    <%= image_tag venue.categories[0].icon, class: "pull-right" %>
                    <%=venue.location.address%><br>
                    <%=venue.location.city%>, <%=venue.location.state%> <%venue.postalCode%><div class="small_space"></div>
                    Check-Ins: <%=venue.stats.checkinsCount%><br>
                    Likes: <%=venue.stats.tipCount%>
                </section>
              </div>
            <%end%>
          <%end%>
        </div>
    </section>
  </section>
</section>

<script type="text/javascript">
  // Set up typeahead
  var setUpLocationTypeahead = function() {
      // Initialize typeahead.
      $(".location_tt").typeahead({
          name: 'location',
          local: <%= LocationCache.last.text.to_s.html_safe %>
      });
  }

  $(document).ready(function(){
    setUpLocationTypeahead();
  });
</script>